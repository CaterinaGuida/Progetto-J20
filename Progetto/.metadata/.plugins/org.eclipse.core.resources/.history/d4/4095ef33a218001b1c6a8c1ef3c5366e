/* Questo test permette di verificare la registrazione di un titolo di viaggio nel database */

package testUnit;


import static org.junit.Assert.*;

import java.sql.*;
import org.junit.Test;

import dao.*;
import model.*;

public class RegistrationTest {

	@Test
	public void test() {
		DaoFactory dao= DaoFactory.getInstance();
		DaoRegister dr= dao.getDaoRegister();
		SingleTicket biglietto= new SingleTicket();
		String codice= biglietto.getTicketCode();
		dr.addSingolo(biglietto);
		Connection con;
		try {
			con = dao.getConnection();
			String query=String.format("select count(*) as num from titoli where codice='%s'",codice);
			Statement st= con.createStatement();
			ResultSet result= st.executeQuery(query);
			int num=0;
			while(result.next()) {
				num= result.getInt("num");
			}
			
			query=String.format("delete from titoli where codice='%s'",codice);
			st.executeUpdate(query);
			
			assertEquals(1,num);
			
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
	
	}

}
